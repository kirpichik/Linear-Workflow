#  Workflow

Вычислительная схема, состоящая из предопределенного набора вычислительных блоков
и связей между ними.

**Данная реализация Workflow является линейной.**

## Описание схемы

```
desc # Описание блоков схемы
id1 = block1
id2 = block2
...
idN = blockN
csed
idA -> idB -> idC -> ... idZ # Описание структуры схемы
```

### Где:

- desc, csed - Ключевые слова, ограничивающие описания блоков.
- id1, ..., idN - целые, неотрицательные, неповторяющиеся числа.
- block1, ..., blockN - Команды из списка команд с обязательными параметрами.
- idA, idB, ..., idZ - числа, принадлежащие множеству id1, ..., idN.
Описание конвейра. Длина неограничена.
- -> - Ключевое слово, обозначающее связь вычислительных узлов.

### Описание блоков (доступных команд)

После описания команды указан принимаемый тип -> возвращаемый тип.

**Возвращаемый тип должен соответствовать принимаемому!**

1. readfile < filename >; None -> Text:

Считывает текстовый файл в память целиком.

2. writefile < filename >; Text -> None:

Записывает текст в файл и является завершением конвейра.

3. grep < word >; Text -> Text:

Выбирает из входного текста строки, разделенные символом переноса строки и содержащие слово заданное слово.

4. sort; Text -> Text:

Сортирует строки текста.

5. replace < pattern > < substitution >; Text -> Text:

Заменяет слова в тексте.

6. dump <filename>; Text -> Text:

Записывает текст в файл.

### Дополнительно:

Допускается отсутствие входного и/или выходного файла для схемы.

В этом случае при запуске требуется указать отсутствующие имена.

Как это сделать, описано ниже.


## Примеры схем

### Пример с указанными входными и выходными файлами

```
desc
1 = replace abracadabra cadabraabra
2 = grep braab
3 = sort
0 = readfile in.txt
5 = writefile out.txt
csed
0 -> 1 -> 2 -> 3 -> 5
```

### Пример без указанных файлов
```
desc
1 = grep some_word
2 = sort
csed
1 -> 2
```

## Сборка

Получаем исходные файлы:

`git clone https://github.com/kirpichik/Linear-Workflow.git`

Переходим в репозиторий:

`cd Linear-Workflow`

Генерируем Bison и Flex файлы:

`cd parser && ./make-flex-bison.sh && cd ..`

Генерируем Makefile:

`mkdir build && cd build && cmake ..`

Выполняем сборку:

`make`

Запускаем тесты:

`./WorkflowTests`

## Запуск

`./Workflow < файл схемы >`

Чтобы указать входные и выходные файлы (если они не указаны в схеме):

`./Workflow -i < входной файл > -o < выходной файл > < файл схемы >`

